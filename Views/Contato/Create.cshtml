@model ContatoModel
@{
    ViewData["Title"] = "Editar fornecedor";
}

<div class="text-center"> 
    <h1 class="display-4">Cadastrar fornecedor</h1>
</div>

<form asp-controller="Contato" asp-action="Create" method="post">
  
  <div class="form-group">
    <label for="nome">Nome</label>
    <input type="text" asp-for="nome" class="form-control" placeholder="Digite o nome">
  </div>

  <div class="form-group">
    <label for="cnpj">CNPJ</label>
    <input type="text" asp-for="cnpj" class="form-control" placeholder="Digite o CNPJ">
  </div>

  <div class="form-group">
    <label for="segmento">Segmento</label>
    <select asp-for="segmento" class="form-control">
        <option></option>
        <option>Comércio</option>
        <option>Serviço</option>
        <option>Indústria</option>
    </select>
  </div>

  <div class="form-group">
    <label for="cep">CEP</label>
    <input type="text" asp-for="cep" class="form-control" placeholder="Digite o CEP" id="cep">
  </div>

  <div class="form-group">
    <label for="endereco">Endereço</label>
    <input type="text" asp-for="endereco" class="form-control" placeholder="Endereço" id="endereco" readonly>
  </div>

<br />
<button type="submit" class="btn btn-primary btn-block">Adicionar</button>
<a class="btn btn-secondary btn-block" asp-controller="Contato" asp-action="Index" role="button">Voltar</a>

</form>

@section Scripts {
    <script>
        document.getElementById("cep").addEventListener("blur", function () {
            var cep = this.value.replace(/\D/g, '');
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.erro) {
                            document.getElementById("endereco").value = `${data.logradouro}, ${data.bairro}, ${data.localidade} - ${data.uf}`;
                        } else {
                            alert("CEP não encontrado.");
                        }
                    })
                    .catch(error => console.error("Erro ao buscar o CEP: ", error));
            } else {
                alert("CEP inválido. Por favor, insira um CEP válido com 8 dígitos.");
            }
        });
    </script>
}
